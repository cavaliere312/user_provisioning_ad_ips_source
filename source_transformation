{
    "user": {
        "condition": "($.emails EMPTY false) && ($.userName EMPTY false)",
        "mappings": [
            {
                "targetPath": "$.id",
                "sourceVariable": "entityIdTargetSystem"
            },
            {
                "targetPath": "$.schemas",
                "constant": [
                    "urn:ietf:params:scim:schemas:core:2.0:User",
                    "urn:ietf:params:scim:schemas:extension:enterprise:2.0:User",
                    "urn:ietf:params:scim:schemas:extension:sap:2.0:User",
                    "urn:sap:cloud:scim:schemas:extension:custom:2.0:User"
                ]
            },
            {
                "sourcePath": "$.sapUserName",
                "targetPath": "$.sapUserName"
            },
            {
                "sourcePath": "$.userName",
                "targetPath": "$.userName"
            },
            {
                "sourcePath": "$.emails",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['emails']",
                "preserveArrayWithSingleElement": true,
                "scope": "createEntity",
                "functions": [
                    {
                        "function": "putIfAbsent",
                        "key": "verified",
                        "defaultValue": true
                    },
                    {
			  "function": "toLowerCaseString",
			  "locale": "en_EN"
			}
                ]
            },
            {
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['emails'][*]['type']",
                "type": "remove"
            },
            {
                "sourcePath": "$.emails[*].value",
                "targetPath": "$.emails[?(@.value)]",
                "preserveArrayWithSingleElement": true
            },
            {
                "sourcePath": "$.name.givenName",
                "targetPath": "$.name.givenName",
                "optional": true
            },
            {
                "sourcePath": "$.name.middleName",
                "targetPath": "$.name.middleName",
                "optional": true
            },
            {
                "sourcePath": "$.name.familyName",
                "targetPath": "$.name.familyName",
                "optional": true
            },
            {
                "sourcePath": "$.name.honorificPrefix",
                "targetPath": "$.name.honorificPrefix",
                "optional": true
            },
            {
                "sourcePath": "$.addresses",
                "targetPath": "$.addresses",
                "optional": true,
                "preserveArrayWithSingleElement": true,
                "functions": [
                    {
                        "function": "putIfAbsent",
                        "key": "type",
                        "defaultValue": "work"
                    },
                    {
                        "function": "putIfPresent",
                        "condition": "(@.type NIN ['work', 'home'])",
                        "key": "type",
                        "defaultValue": "work"
                    }
                ],
                "defaultValue": []
            },
            {
                "sourcePath": "$.phoneNumbers",
                "targetPath": "$.phoneNumbers",
                "optional": true,
                "preserveArrayWithSingleElement": true
            },
            {
                "sourcePath": "$.displayName",
                "targetPath": "$.displayName",
                "optional": true
            },
            {
                "sourcePath": "$.userType",
                "targetPath": "$.userType",
                "optional": true
            },
            {
                "sourcePath": "$.locale",
                "targetPath": "$.locale",
                "optional": true
            },
            {
                "sourcePath": "$.timezone",
                "targetPath": "$.timeZone",
                "optional": true
            },
            {
                "sourcePath": "$.active",
                "targetPath": "$.active",
                "optional": true,
                "defaultValue": true
            },
            {
                "sourcePath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['validFrom']",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['validFrom']",
                "optional": true
            },
            {
                "sourcePath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['validTo']",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['validTo']",
                "optional": true
            },
            {
                "sourcePath": "$.employeeId",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['employeeNumber']",
                "optional": true
            },
            {
                "sourcePath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['costCenter']",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['costCenter']",
                "optional": true
            },
            {
                "sourcePath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['organization']",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['organization']",
                "optional": true
            },
            {
                "sourcePath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['division']",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['division']",
                "optional": true
            },
            {
                "sourcePath": "$.department",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['department']",
                "optional": false
            },
            {
                "sourcePath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['manager']['value']",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['manager']['value']",
                "optional": true,
                "functions": [
                    {
                        "function": "resolveEntityIds"
                    }
                ]
            },
            {
                "sourcePath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['manager']['displayName']",
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:enterprise:2.0:User']['manager']['displayName']",
                "optional": true
            },
            {
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['sendMail']",
                "constant": false,
                "scope": "createEntity"
            },
            {
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['mailVerified']",
                "constant": true,
                "scope": "createEntity"
            },
            {
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['passwordDetails']['status']",
                "constant": "disabled",
                "scope": "createEntity"
            },
            {
                "sourcePath": "$['urn:sap:cloud:scim:schemas:extension:custom:2.0:User']['attributes']",
                "targetPath": "$['urn:sap:cloud:scim:schemas:extension:custom:2.0:User']['attributes']",
                "optional": true,
                "preserveArrayWithSingleElement": true
            },
            {
                "targetPath": "$.password",
                "ignore": true,
                "constant": "<your-initial-password>",
                "scope": "createEntity"
            },
            {
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['sourceSystem']",
                "ignore": true,
                "constant": "<your-source-system-type-code>",
                "scope": "createEntity"
            },
            {
                "targetPath": "$['urn:ietf:params:scim:schemas:extension:sap:2.0:User']['sourceSystemId']",
                "ignore": true,
                "constant": "<your-source-system-id>",
                "scope": "createEntity"
            }
        ]
    },
    "group": {
        "mappings": [
            {
                "targetPath": "$.id",
                "sourceVariable": "entityIdTargetSystem"
            },
            {
                "targetPath": "$.schemas",
                "constant": [
                    "urn:ietf:params:scim:schemas:core:2.0:Group",
                    "urn:sap:cloud:scim:schemas:extension:custom:2.0:Group"
                ]
            },
            {
                "sourcePath": "$.displayName",
                "targetPath": "$.displayName"
            },
            {
                "sourcePath": "$.members[*].value",
                "targetPath": "$.members[?(@.value)]",
                "optional": true,
                "preserveArrayWithSingleElement": true,
                "functions": [
                    {
                        "function": "resolveEntityIds",
                        "entityType": "user"
                    }
                ]
            },
            {
                "sourcePath": "$.members[*].value",
                "targetPath": "$.members[?(@.value)]",
                "optional": true,
                "preserveArrayWithSingleElement": true,
                "functions": [
                    {
                        "function": "resolveEntityIds",
                        "entityType": "group"
                    }
                ]
            },
            {
                "sourcePath": "$.displayName",
                "targetPath": "$['urn:sap:cloud:scim:schemas:extension:custom:2.0:Group']['name']",
                "scope": "createEntity"
            },
            {
                "sourcePath": "$['urn:sap:cloud:scim:schemas:extension:custom:2.0:Group']['name']",
                "targetPath": "$['urn:sap:cloud:scim:schemas:extension:custom:2.0:Group']['name']",
                "optional": true,
                "scope": "createEntity"
            },
            {
                "sourcePath": "$['urn:sap:cloud:scim:schemas:extension:custom:2.0:Group']['description']",
                "targetPath": "$['urn:sap:cloud:scim:schemas:extension:custom:2.0:Group']['description']",
                "optional": true
            }
        ]
    }
}
